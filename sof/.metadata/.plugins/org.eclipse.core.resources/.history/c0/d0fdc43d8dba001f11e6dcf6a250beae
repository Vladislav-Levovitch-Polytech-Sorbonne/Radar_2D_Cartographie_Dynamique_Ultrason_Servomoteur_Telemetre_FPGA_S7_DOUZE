#include <stdio.h>
#include "system.h"
#include "altera_avalon_pio_regs.h"
#include "unistd.h"
#include "stdio.h"
#include "io.h"
//#define AVALON_SERVOMOTEUR_BASE 0x04000000
int value = 0;
int main()
{

  printf("Valeur actuelle : %d\n", value);
  IOWR_16DIRECT(AVALON_SERVOMOTEUR_BASE, 0, value);

  printf("Valeur actuelle : %d\n", value);
  usleep(700000);
  while (1)
  {
	  //int value = IORD(0x04000000, 0);
	  printf("Valeur actuelle : %d\n", value);
	  value += 10;
	  //IOWR(0x04000000, 0, 0b0000000111000010); // Écriture en binaire
	  IOWR_16DIRECT(AVALON_SERVOMOTEUR_BASE, 0, value); // Écriture en binaire
	  usleep(10000);
	  if (value>1540)
	  {
		  value = 0;
		  IOWR_16DIRECT(AVALON_SERVOMOTEUR_BASE, 0, value);
		  printf("Valeur actuelle : %d\n", value);
		  usleep(1000000);
	  }
  }
  return 0;
}
